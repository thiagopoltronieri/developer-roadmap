import{j as e}from"./jsx-runtime.391947bd.js";import{r as s}from"./index.ed373d49.js";import{c as z,d as F,a as L}from"./http.64a7434f.js";import{S as P}from"./Spinner.cc2f813e.js";import{U as H}from"./UploadProfilePicture.9c58a2cd.js";import{p as R}from"./page.c1a8a472.js";import{u as C}from"./use-team-id.b856293f.js";import{u as q}from"./use-outside-click.54b69c89.js";import{u as G}from"./use-keydown.0305ad6b.js";import{u as E}from"./use-toast.fb52de5d.js";import{$ as A}from"./team.12f2469e.js";import{u as O}from"./index.9435383e.js";import"./jwt.1b92699e.js";import"./index.a98c85f5.js";import"./toast.1fe7142d.js";function W(g){const{onClose:l}=g,v=E(),u=s.useRef(null),n=s.useRef(null),[d,o]=s.useState(!1),[m,i]=s.useState(""),[p,f]=s.useState(""),{teamId:h}=C();q(u,()=>{l()}),G("Escape",()=>{l()}),s.useEffect(()=>{n.current?.focus()},[]);const b=async c=>{if(c.preventDefault(),o(!0),i(""),p.toUpperCase()!=="DELETE"){i("Verification text does not match"),o(!1);return}const{response:j,error:a}=await z(`https://api.roadmap.sh/v1-delete-team/${h}`);if(a||!j){o(!1),i(a?.message||"Something went wrong");return}v.success("Team deleted successfully"),window.location.href="/account"},y=()=>{o(!1),i(""),f(""),l()};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"fixed left-0 right-0 top-0 z-50 flex h-full items-center justify-center overflow-y-auto overflow-x-hidden bg-black/50",children:e.jsx("div",{className:"relative h-full w-full max-w-md p-4 md:h-auto",children:e.jsxs("div",{ref:u,className:"popup-body relative rounded-lg bg-white p-4 shadow",children:[e.jsx("h2",{className:"text-2xl font-semibold text-black",children:"Delete Team"}),e.jsx("p",{className:"text-gray-500",children:"This will permanently delete your team and all associated data."}),e.jsx("p",{className:"-mb-2 mt-3 text-base font-medium text-black",children:'Please type "delete" to confirm.'}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"my-4",children:[e.jsx("input",{ref:n,type:"text",name:"delete-account",id:"delete-account",className:"mt-2 block w-full rounded-md border border-gray-300 px-3 py-2 outline-none placeholder:text-gray-400 focus:border-gray-400",placeholder:'Type "delete" to confirm',required:!0,autoFocus:!0,value:p,onInput:c=>f(c.target.value)}),m&&e.jsx("p",{className:"mt-2 rounded-lg bg-red-100 p-2 text-red-700",children:m})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",disabled:d,onClick:y,className:"flex-grow cursor-pointer rounded-lg bg-gray-200 py-2 text-center",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d||p.toUpperCase()!=="DELETE",className:"flex-grow cursor-pointer rounded-lg bg-red-500 py-2 text-white disabled:opacity-40",children:d?"Please wait ..":"Confirm"})]})]})]})})})})}function oe(){const[g,l]=s.useState(!1),[v,u]=s.useState(!1),n=O(A),d=E(),[o,m]=s.useState(""),[i,p]=s.useState(""),[f,h]=s.useState(""),[b,y]=s.useState(""),[c,j]=s.useState(""),[a,N]=s.useState(""),[k,S]=s.useState(""),D=["0-1","2-10","11-50","51-200","201-500","501-1000","1000+"],[r,U]=s.useState(!1),{teamId:x}=C();s.useEffect(()=>{U(!n)},[n]);const $=async t=>{if(t.preventDefault(),l(!0),!o||!a){l(!1);return}const{response:w,error:I}=await F(`https://api.roadmap.sh/v1-update-team/${x}`,{name:o,website:f,type:a,gitHubUrl:c||void 0,...a==="company"&&{teamSize:k,linkedInUrl:b||void 0}});if(I){l(!1),d.error(I.message||"Something went wrong");return}w&&(await T(),l(!1),d.success("Team updated successfully"))};async function T(){const{response:t,error:w}=await L(`https://api.roadmap.sh/v1-get-team/${x}`);if(w||!t){console.log(w);return}m(t.name),p(t.avatar||""),h(t?.links?.website||""),y(t?.links?.linkedIn||""),j(t?.links?.github||""),N(t.type),t.teamSize&&S(t.teamSize)}return s.useEffect(()=>{x&&T().finally(()=>{R.set("")})},[x]),e.jsxs("div",{children:[e.jsx(H,{isDisabled:r,type:"logo",avatarUrl:i?`https://dodrc8eu8m09s.cloudfront.net/avatars/${i}`:"/images/default-avatar.png",teamId:x}),e.jsxs("form",{onSubmit:$,children:[e.jsxs("div",{className:"mt-4 flex w-full flex-col",children:[e.jsx("label",{htmlFor:"name",className:'text-sm leading-none text-slate-500 after:text-red-400 after:content-["*"]',children:"Name"}),e.jsx("input",{type:"text",name:"name",id:"name",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"roadmap.sh",disabled:r,required:!0,value:o,onInput:t=>m(t.target.value)})]}),e.jsxs("div",{className:"mt-4 flex w-full flex-col",children:[e.jsx("label",{htmlFor:"website",className:`text-sm leading-none text-slate-500 ${a==="company"?'after:content-["*"]':""}`,children:"Website"}),e.jsx("input",{required:a==="company",type:"text",name:"website",id:"website",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://roadmap.sh",disabled:r,value:f,onInput:t=>h(t.target.value)})]}),a==="company"&&e.jsxs("div",{className:"mt-4 flex w-full flex-col",children:[e.jsx("label",{htmlFor:"linkedIn",className:"text-sm leading-none text-slate-500",children:"LinkedIn URL"}),e.jsx("input",{type:"text",name:"linkedIn",id:"linkedIn",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://linkedin.com/company/roadmapsh",disabled:r,value:b,onInput:t=>y(t.target.value)})]}),e.jsxs("div",{className:"mt-4 flex w-full flex-col",children:[e.jsx("label",{htmlFor:"gitHub",className:"text-sm leading-none text-slate-500",children:"GitHub URL"}),e.jsx("input",{type:"text",name:"gitHub",id:"gitHub",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://github.com/roadmapsh",disabled:r,value:c,onInput:t=>j(t.target.value)})]}),e.jsxs("div",{className:"mt-4 flex w-full flex-col",children:[e.jsx("label",{htmlFor:"type",className:'text-sm leading-none text-slate-500  after:text-red-400 after:content-["*"]',children:"Type"}),e.jsxs("select",{name:"type",id:"type",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",disabled:r,value:a||"",onChange:t=>N(t.target.value),children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"company",children:"Company"}),e.jsx("option",{value:"study_group",children:"Study Group"})]})]}),a==="company"&&e.jsxs("div",{className:"mt-4 flex w-full flex-col",children:[e.jsx("label",{htmlFor:"team-size",className:'text-sm leading-none text-slate-500 after:text-red-400 after:content-["*"]',children:"Team size"}),e.jsxs("select",{name:"team-size",id:"team-size",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",required:a==="company",disabled:r,value:k,onChange:t=>S(t.target.value),children:[e.jsx("option",{value:"",selected:!0,children:"Select team size"}),D.map(t=>e.jsxs("option",{value:t,children:[t," people"]}))]})]}),e.jsx("div",{className:"mt-4 flex w-full flex-col",children:e.jsx("button",{type:"submit",className:"inline-flex h-11 w-full items-center justify-center rounded-lg bg-black p-2 py-3 text-sm font-medium text-white outline-none focus:ring-2 focus:ring-black focus:ring-offset-1 disabled:bg-gray-400",disabled:r||g,children:g?e.jsx(P,{}):"Update"})})]}),!n&&e.jsx("p",{className:"mt-2 rounded-lg border border-red-300 bg-red-50 p-2 text-sm text-red-700",children:"Only team admins can update team information."}),n&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-8"}),v&&e.jsx(W,{onClose:()=>{u(!1)}}),e.jsx("h2",{className:"text-xl font-bold sm:text-2xl",children:"Delete Team"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Permanently delete this team and all of its resources."}),e.jsx("button",{onClick:()=>u(!0),"data-popup":"delete-team-popup",className:"font-regular mt-4 w-full rounded-lg bg-red-600 py-2 text-base text-white outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-1",children:"Delete Team"})]})]})}export{oe as UpdateTeamForm};
