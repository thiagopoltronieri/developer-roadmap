import{j as e}from"./jsx-runtime.391947bd.js";import{r as a}from"./index.ed373d49.js";import{D as y}from"./dropdown.e91a0d66.js";import{a as S}from"./http.64a7434f.js";import{u as I}from"./use-auth.2b975076.js";import{u as $}from"./use-outside-click.54b69c89.js";import{S as C}from"./Spinner.cc2f813e.js";import{b as h,c as g}from"./team.12f2469e.js";import{u as w}from"./index.9435383e.js";import{u as L}from"./use-team-id.b856293f.js";import{u as D}from"./use-toast.fb52de5d.js";import"./jwt.1b92699e.js";import"./index.a98c85f5.js";import"./toast.1fe7142d.js";function K(){const m=I(),{teamId:i}=L(),[j,v]=a.useState(!1);a.useEffect(()=>{const s=localStorage.getItem("viewedTeamsCount"),t=parseInt(s||"0",10),x=t<5;v(x),x&&localStorage.setItem("viewedTeamsCount",(t+1).toString())},[]);const r=w(g),n=w(h),b=D(),c=a.useRef(null),[o,d]=a.useState(!0),[u,p]=a.useState(!1),f=n?n.avatar:m?.avatar,N=n?n.name:m?.name;$(c,()=>{p(!1)});async function T(){const{response:s,error:t}=await S("https://api.roadmap.sh/v1-get-user-teams");if(t||!s){b.error(t?.message||"Something went wrong");return}g.set(s)}a.useEffect(()=>{!i||!r||h.set(r.find(s=>s._id===i))},[r,i]),a.useEffect(()=>{d(!0),T().finally(()=>{d(!1)})},[]);const l=r.filter(s=>s.status==="invited").map(s=>s._id);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mr-2",children:[e.jsxs("span",{className:"mb-2 flex items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{children:"Choose Team"}),j&&e.jsx("span",{className:"mr-1 inline-flex h-1 w-1 items-center justify-center font-medium text-blue-300",children:e.jsxs("span",{className:"relative flex items-center",children:[e.jsx("span",{className:"relative rounded-full bg-gray-200 p-1 text-xs"}),e.jsx("span",{className:"absolute bottom-0 left-0 right-0 top-0 animate-ping rounded-full bg-gray-400 p-1 text-xs"})]})})]}),e.jsxs("button",{className:"flex w-full cursor-pointer items-center justify-between rounded border p-2 text-sm hover:bg-gray-100",onClick:()=>p(!u),children:[l.length>0&&e.jsx("span",{className:"absolute -left-1.5 -top-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-xs font-medium text-white",children:l.length}),e.jsxs("div",{className:"mr-1.5 inline-grid grid-cols-[16px_auto] items-center gap-1.5",children:[o&&e.jsx(C,{className:"h-4 w-4",isDualRing:!1}),!o&&e.jsx("img",{src:f?`https://dodrc8eu8m09s.cloudfront.net/avatars/${f}`:"/images/default-avatar.png",alt:"",className:"h-4 w-4 rounded-full object-cover"}),e.jsxs("span",{className:"truncate",children:[!o&&N,o&&"Loading .."]})]}),e.jsx("img",{alt:"show dropdown",src:y.src,className:"h-4 w-4"})]}),u&&e.jsxs("div",{ref:c,className:"absolute top-full z-50 mt-2 w-full rounded-md bg-slate-800 px-2 py-2 text-white shadow-md",children:[e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("a",{className:"flex w-full cursor-pointer items-center gap-2 truncate rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",href:"/account",children:e.jsx("span",{className:"truncate",children:"Personal Account"})})}),r.map(s=>{let t="";return s.status==="invited"?t=`/respond-invite?i=${s.memberId}`:s.status==="joined"&&(t=`/team/progress?t=${s._id}`),e.jsx("li",{children:e.jsxs("a",{className:"flex w-full cursor-pointer items-center gap-2 rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",href:`${t}`,children:[e.jsx("span",{className:"min-w-0 flex-grow truncate",children:s.name}),l.includes(s._id)&&e.jsx("span",{className:"flex rounded-md bg-red-500 px-2 text-xs text-white",children:"Invite"})]})},s?._id)})]}),e.jsxs("a",{className:"mt-2 flex w-full cursor-pointer items-center justify-center gap-2 rounded bg-gray-100 p-2 text-sm font-medium text-slate-800 hover:opacity-90",href:"/team/new",children:[e.jsx("span",{children:"+"}),e.jsx("span",{children:"New Team"})]})]})]}),e.jsx("hr",{className:"my-4"})]})}export{K as TeamDropdown};
