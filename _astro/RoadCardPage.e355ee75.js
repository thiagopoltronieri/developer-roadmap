import{h as x,p as w}from"./hooks.module.6eb5c72e.js";import{u as b}from"./use-copy-text.dccffc0b.js";import{u as v}from"./use-auth.13ac07ad.js";import{C as y}from"./copy.e1103b2a.js";import{a as N}from"./http.82ebf0f1.js";import{p as k}from"./page.c1a8a472.js";import{o as e}from"./jsxRuntime.module.c6f75409.js";import{k as C}from"./preact.module.346aa314.js";import"./jwt.f0e0aa9c.js";import"./index.a98c85f5.js";function p(s){const{text:r,isDisabled:l,isSelected:n,onClick:o}=s;return e("button",{className:`rounded-md border p-1 px-2 text-sm ${n?" border-gray-500 bg-gray-300 ":""} ${l?" cursor-not-allowed opacity-40 ":" cursor-pointer "}`,onClick:o,children:r})}function S(s){const{selectedRoadmaps:r,setSelectedRoadmaps:l}=s,[n,o]=x(),c=async()=>{const{response:t,error:a}=await N("https://api.roadmap.sh/v1-get-user-all-progress");a||!t||o(t)};w(()=>{c().finally(()=>{k.set("")})},[]);const d=r.length<4,i=n?.filter(t=>t.resourceType==="roadmap")||[];return e("div",{className:"flex flex-wrap gap-1",children:[i?.length===0&&e("p",{className:"text-sm text-gray-400 italic",children:"No progress tracked so far."}),i?.map(t=>{const a=r.includes(t.resourceId),u=a||d;return e(p,{text:t.resourceTitle,isDisabled:!u,isSelected:a,onClick:()=>{a?l(r.filter(m=>m!==t.resourceId)):r.length<4&&l([...r,t.resourceId])}})})]})}function R(){return e("p",{className:"mt-3 rounded-md border p-2 text-sm w-full bg-yellow-100 border-yellow-400 text-yellow-900",children:["Add this badge to your"," ",e("a",{href:"https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-profile/customizing-your-profile/managing-your-profile-readme",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-800",children:"GitHub profile readme."})]})}async function $({url:s,name:r,extension:l="png",scale:n=1}){try{const c=await(await fetch(s)).text(),d=`data:image/svg+xml;base64,${window.btoa(c)}`,i=new Image;i.src=d,i.onload=()=>{const t=document.createElement("canvas");t.width=i.width*n,t.height=i.height*n,t.getContext("2d")?.drawImage(i,0,0,t.width,t.height);const u=t.toDataURL("image/png",1),m=document.createElement("a");m.href=u,m.download=`${r}.${l}`,m.click()}}catch{alert("Error downloading image")}}function g(s){const{step:r}=s;return e("span",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full bg-gray-300 text-white",children:r})}function f(s){const{text:r,title:l}=s,{isCopied:n,copyText:o}=b();return e("div",{className:"flex w-full flex-grow flex-col overflow-hidden rounded border border-gray-300 bg-gray-50",children:[e("div",{className:"flex items-center justify-between gap-2 border-b border-gray-300 px-3 py-2",children:[e("span",{className:"text-xs uppercase leading-none text-gray-400",children:l}),e("button",{className:"flex items-center",onClick:()=>o(r),children:[n&&e("span",{className:"mr-1 text-xs leading-none text-gray-700",children:"Copied!"}),e("img",{src:y,alt:"Copy",className:"inline-block h-4 w-4"})]})]}),e("textarea",{className:"no-scrollbar block h-12 w-full overflow-x-auto whitespace-nowrap bg-gray-200/70 p-3 text-sm text-gray-900 focus:bg-gray-50 focus:outline-0",readOnly:!0,onClick:c=>{c.target.select(),o(c.target.value)},children:r})]})}function h(s){const{label:r}=s;return e("span",{className:"mb-3 flex items-center gap-2 text-sm leading-none text-gray-400",children:r})}function U(){const{isCopied:s,copyText:r}=b(),[l,n]=x([]),[o,c]=x("tall"),[d,i]=x("dark"),t=v();if(!t)return null;const a=new URL(`https://api.roadmap.sh/v1-badge/${o}/${t?.id}`);return a.searchParams.set("variant",d),l.length>0&&a.searchParams.set("roadmaps",l.join(",")),e(C,{children:[e("div",{className:"flex items-start gap-4 mx-0 sm:-mx-10 px-0 sm:px-10 border-b pt-2 pb-4",children:[e(g,{step:1}),e("div",{children:[e(h,{label:"Pick progress to show (Max. 4)"}),e("div",{className:"flex flex-wrap",children:e(S,{selectedRoadmaps:l,setSelectedRoadmaps:n})})]})]}),e("div",{className:"flex items-start gap-4 mx-0 sm:-mx-10 px-0 sm:px-10 border-b py-4",children:[e(g,{step:2}),e("div",{children:[e(h,{label:"Select Mode (Dark vs Light)"}),e("div",{className:"flex gap-2",children:[e(p,{text:"Dark",isDisabled:!1,isSelected:d==="dark",onClick:()=>{i("dark")}}),e(p,{text:"Light",isDisabled:!1,isSelected:d==="light",onClick:()=>{i("light")}})]})]})]}),e("div",{className:"flex items-start gap-4 mx-0 sm:-mx-10 px-0 sm:px-10 border-b py-4",children:[e(g,{step:3}),e("div",{children:[e(h,{label:"Select Version"}),e("div",{className:"flex gap-2",children:[e(p,{text:"Tall",isDisabled:!1,isSelected:o==="tall",onClick:()=>{c("tall")}}),e(p,{text:"Wide",isDisabled:!1,isSelected:o==="wide",onClick:()=>{c("wide")}})]})]})]}),e("div",{className:"flex items-start gap-4 mx-0 sm:-mx-10 px-0 sm:px-10 border-b py-4",children:[e(g,{step:4}),e("div",{class:"flex-grow",children:[e(h,{label:"Share your #RoadCard with others"}),e("div",{className:"rounded-md border bg-gray-50 p-2 text-center",children:e("a",{href:a.toString(),target:"_blank",rel:"noopener noreferrer",className:`relative block hover:cursor-pointer ${o==="tall"?" max-w-[270px] ":" w-full "}`,children:e("img",{src:a.toString(),alt:"RoadCard"})})}),e("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[e("button",{className:"flex items-center justify-center rounded border border-gray-300 p-1.5 px-2 text-sm font-medium",onClick:()=>$({url:a.toString(),name:"road-card",scale:4}),children:"Download"}),e("button",{disabled:s,className:"flex cursor-pointer items-center justify-center rounded border border-gray-300 p-1.5 px-2 text-sm font-medium disabled:bg-blue-50",onClick:()=>r(a.toString()),children:[e("img",{alt:"Copy",src:y,className:"mr-1"}),s?"Copied!":"Copy Link"]})]}),e("div",{className:"mt-3 flex flex-col gap-3",children:[e(f,{title:"HTML",text:`<a href="https://roadmap.sh"><img src="${a}" alt="roadmap.sh"/></a>`.trim()}),e(f,{title:"Markdown",text:`[![roadmap.sh](${a})](https://roadmap.sh)`.trim()})]}),e(R,{})]})]})]})}export{U as RoadCardPage};
