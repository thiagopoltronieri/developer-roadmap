import{a as v,T as y}from"./jwt.f0e0aa9c.js";import{h as u,_ as N,p as U}from"./hooks.module.6eb5c72e.js";import{o as e}from"./jsxRuntime.module.c6f75409.js";function j(r){return new Promise(a=>{const n=new Image;n.onload=()=>{a({width:n.width,height:n.height})},n.onerror=()=>{a({width:0,height:0})},n.src=URL.createObjectURL(r)})}async function L(r){const a=await j(r);return a.width>3e3||a.height>3e3?"Image dimensions are too big. Maximum 3000x3000 pixels.":a.width<100||a.height<100?"Image dimensions are too small. Minimum 100x100 pixels.":r.size>1024*1024?"Image size is too big. Maximum 1MB.":null}function k(r){const{avatarUrl:a,teamId:n,type:b,isDisabled:l=!1}=r,[t,g]=u(null),[p,s]=u(""),[d,h]=u(!1),c=N(null),w=async m=>{s("");const i=m.target.files?.[0];if(!i)return;const o=await L(i);if(o){s(o);return}g(Object.assign(i,{preview:URL.createObjectURL(i)}))},x=async m=>{if(m.preventDefault(),s(""),h(!0),!t)return;const i=new FormData;i.append("name","avatar"),i.append("avatar",t);let o;if(b==="avatar"?o=await fetch("https://api.roadmap.sh/v1-upload-profile-picture",{method:"POST",body:i,credentials:"include"}):o=await fetch(`https://api.roadmap.sh/v1-upload-team-logo/${n}`,{method:"POST",body:i,credentials:"include"}),o.ok){window.location.reload();return}const f=await o.json();s(f?.message||"Something went wrong"),h(!1),f.status===401&&(v.remove(y),window.location.reload())};return U(()=>()=>{t&&URL.revokeObjectURL(t.preview)},[t]),e("form",{onSubmit:x,encType:"multipart/form-data",className:"flex flex-col gap-2",children:[r.label&&e("label",{htmlFor:"avatar",className:"text-sm leading-none text-slate-500",children:r.label}),e("div",{className:"mb-2 mt-2 flex items-center gap-2",children:[e("label",{htmlFor:"avatar",title:"Change profile picture",className:"relative cursor-pointer",children:[e("div",{className:"relative block h-24 w-24 items-center overflow-hidden rounded-full",children:e("img",{className:"absolute inset-0 h-full w-full bg-gray-100 object-cover text-sm leading-8 text-red-700",src:t?.preview||a,alt:t?.name??"Error!",loading:"lazy",decoding:"async",onLoad:()=>t&&URL.revokeObjectURL(t.preview)})}),!t&&!l&&e("button",{disabled:l,type:"button",className:"absolute bottom-1 right-0 rounded bg-gray-600 px-2 py-1 text-xs leading-none text-gray-50 ring-2 ring-white",onClick:()=>{d||c.current?.click()},children:"Edit"})]}),e("input",{disabled:l,ref:c,id:"avatar",type:"file",name:"avatar",accept:"image/png, image/jpeg, image/jpg, image/pjpeg",className:"hidden",onChange:w}),t&&e("div",{className:"ml-5 flex items-center gap-2",children:[e("button",{type:"button",onClick:()=>{g(null),c.current?.value&&(c.current.value="")},className:"flex h-9 min-w-[96px] items-center justify-center rounded-md border border-red-300 bg-red-100 text-sm font-medium text-red-700 disabled:cursor-not-allowed disabled:opacity-60",disabled:d||l,children:"Cancel"}),e("button",{type:"submit",className:"flex h-9 min-w-[96px] items-center justify-center rounded-md border border-gray-300 text-sm font-medium text-black disabled:cursor-not-allowed disabled:opacity-60",disabled:d||l,children:d?"Uploading..":"Upload"})]})]}),p&&e("p",{className:"mt-2 rounded-lg bg-red-100 p-2 text-red-700",children:p})]})}export{k as U};
