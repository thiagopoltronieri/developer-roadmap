function k(d){let t=d>>16&255,r=d>>8&255,e=d&255;return`rgb(${t},${r},${e})`}function p(d,t={},r){let e=document.createElementNS("http://www.w3.org/2000/svg",d);for(let o in t)t.hasOwnProperty(o)&&e.setAttribute(o,t[o]);return r&&r.appendChild(e),e}const h=2.7,$=4,b=2,w={black:["#000"],gray:["#000","#333","#666","#999","#ccc","#ddd","#eee"],white:["#fff"],red:["#cf2a27","#ea9999","#eo6666","#cc0000","#990000","#660000"],orange:["#ff9900","#f9cb9c","#f6b26b","#e69138","#b45f06","#783f04"],yellow:["#ffff00","#ffe599","#ffd966","#f1c232","#bf9000","#7f6000"],green:["#009e0f","#b6d7a8","#93c47d","#6aa84f","#38761d","#274e13"],cyan:["#00ffff","#a2c4c9","#76a5af","#45818e","#134f5c","#0c343d"],blue:["#2b78e4","#9fc5f8","#6fa8dc","#597eaa","#085394","#073763"],purple:["#9900ff","#b4a7d6","#8e7cc3","#674ea7","#351c75","#20124d"],pink:["#ff00ff","#d5a6bd","#c27ba0","#a64d79","#741b47","#4c1130"]};class I{constructor(t,r){this.svgRoot=t,this.fontFamily=r,this.canvasRenderingContext2D=document.createElement("canvas").getContext("2d")}render(t,r){let e=t.typeID;e in this?this[e](t,r):console.log(`'${e}' control type not implemented`)}parseColor(t,r){return t===void 0?`rgb(${r})`:k(t)}parseFontProperties(t){var r,e,o;return{style:(r=t.properties)!=null&&r.italic?"italic":"normal",weight:(e=t.properties)!=null&&e.bold?"bold":"normal",size:(o=t.properties)!=null&&o.size?t.properties.size+"px":"13px",family:this.fontFamily}}measureText(t,r){return this.canvasRenderingContext2D.font=r,this.canvasRenderingContext2D.measureText(t)}drawRectangle(t,r){var e,o,s;p("rect",{x:parseInt(t.x)+h/2,y:parseInt(t.y)+h/2,width:parseInt(t.w??t.measuredW)-h,height:parseInt(t.h??t.measuredH)-h,rx:b,fill:this.parseColor((e=t.properties)==null?void 0:e.color,"255,255,255"),"fill-opacity":((o=t.properties)==null?void 0:o.backgroundAlpha)??1,stroke:this.parseColor((s=t.properties)==null?void 0:s.borderColor,"0,0,0"),"stroke-width":h},r)}addText(t,r,e,o){let s=t.properties.text??"",n=parseInt(t.x),l=parseInt(t.y),a=this.parseFontProperties(t),i=this.measureText(s,`${a.style} ${a.weight} ${a.size} ${a.family}`),c=o==="center"?n+(t.w??t.measuredW)/2-i.width/2:n,x=l+t.measuredH/2+i.actualBoundingBoxAscent/2,f=p("text",{x:c,y:x,fill:e,"font-style":a.style,"font-weight":a.weight,"font-size":a.size},r);if(!s.includes("{color:")){let y=p("tspan",{},f);y.textContent=s;return}s.split(/{color:|{color}/).forEach(y=>{if(y.includes("}")){let[u,g]=y.split("}");if(!u.startsWith("#")){let m=parseInt(u.slice(-1));u=isNaN(m)?w[u][0]:w[u][m]}let v=p("tspan",{fill:u},f);v.textContent=g}else{let u=p("tspan",{},f);u.textContent=y}})}TextArea(t,r){this.drawRectangle(t,r)}Canvas(t,r){this.drawRectangle(t,r)}Label(t,r){var e;this.addText(t,r,this.parseColor((e=t.properties)==null?void 0:e.color,"0,0,0"),"left")}TextInput(t,r){var e;this.drawRectangle(t,r),this.addText(t,r,this.parseColor((e=t.properties)==null?void 0:e.textColor,"0,0,0"),"center")}Arrow(t,r){var e,o,s;let n=parseInt(t.x),l=parseInt(t.y),{p0:a,p1:i,p2:c}=t.properties,x;((e=t.properties)==null?void 0:e.stroke)==="dotted"?x="0.8 12":((o=t.properties)==null?void 0:o.stroke)==="dashed"&&(x="28 46");let f={x:(c.x-a.x)*i.x,y:(c.y-a.y)*i.x};p("path",{d:`M${n+a.x} ${l+a.y}Q${n+a.x+f.x+f.y*i.y*3.6} ${l+a.y+f.y+-f.x*i.y*3.6} ${n+c.x} ${l+c.y}`,fill:"none",stroke:this.parseColor((s=t.properties)==null?void 0:s.color,"0,0,0"),"stroke-width":$,"stroke-linecap":"round","stroke-linejoin":"round","stroke-dasharray":x},r)}Icon(t,r){var e;let o=parseInt(t.x),s=parseInt(t.y),n=10;p("circle",{cx:o+n,cy:s+n,r:n,fill:this.parseColor((e=t.properties)==null?void 0:e.color,"0,0,0")},r),t.properties.icon.ID==="check-circle"&&p("path",{d:`M${o+4.5} ${s+n}L${o+8.5} ${s+n+4} ${o+15} ${s+n-2.5}`,fill:"none",stroke:"#fff","stroke-width":3.5,"stroke-linecap":"round","stroke-linejoin":"round"},r)}HRule(t,r){var e,o,s;let n=parseInt(t.x),l=parseInt(t.y),a;((e=t.properties)==null?void 0:e.stroke)==="dotted"?a="0.8, 8":((o=t.properties)==null?void 0:o.stroke)==="dashed"&&(a="18, 30"),p("path",{d:`M${n} ${l}L${n+parseInt(t.w??t.measuredW)} ${l}`,fill:"none",stroke:this.parseColor((s=t.properties)==null?void 0:s.color,"0,0,0"),"stroke-width":h,"stroke-linecap":"round","stroke-linejoin":"round","stroke-dasharray":a},r)}__group__(t,r){var e;const o=((e=t?.properties)==null?void 0:e.controlName)||"";let s=p("g",{...o?{class:"clickable-group","data-group-id":o}:{}},r);t.children.controls.control.sort((n,l)=>n.zOrder-l.zOrder).forEach(n=>{n.x=parseInt(n.x,10)+parseInt(t.x,10),n.y=parseInt(n.y,10)+parseInt(t.y,10),this.render(n,s)})}}async function C(d,t={}){if(t={padding:5,fontFamily:"balsamiq",fontURL:"https://fonts.gstatic.com/s/balsamiqsans/v3/P5sEzZiAbNrN8SB3lQQX7Pncwd4XIA.woff2",...t},t.fontURL){let i=new FontFace(t.fontFamily,`url(${t.fontURL})`);await i.load(),document.fonts.add&&document.fonts.add(i)}let r=d.mockup,e=r.measuredW-r.mockupW-t.padding,o=r.measuredH-r.mockupH-t.padding,s=parseInt(r.mockupW)+t.padding*2,n=parseInt(r.mockupH)+t.padding*2,l=p("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:`${e} ${o} ${s} ${n}`,style:"font-family: balsamiq"}),a=new I(l,t.fontFamily);return r.controls.control.sort((i,c)=>i.zOrder-c.zOrder).forEach(i=>{a.render(i,l)}),l}export{C as D};
