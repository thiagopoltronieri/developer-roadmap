import{j as e}from"./jsx-runtime.391947bd.js";import{r as a}from"./index.ed373d49.js";import{a as x,b as g}from"./http.64a7434f.js";import{p as u}from"./page.c1a8a472.js";import{u as j}from"./use-toast.fb52de5d.js";import"./jwt.1b92699e.js";import"./index.a98c85f5.js";import"./toast.1fe7142d.js";const v={src:"/_astro/close-dark.31554c39.svg",width:20,height:20,format:"svg"},b={src:"/_astro/accept.cf157bb4.svg",width:24,height:24,format:"svg"};function $(){const p=j(),[n,i]=a.useState(!1),[r,o]=a.useState([]),[N,c]=a.useState(""),h=async()=>{const{error:t,response:s}=await x("https://api.roadmap.sh/v1-get-invitation-list");if(t||!s){p.error(t?.message||"Something went wrong");return}o(s)};async function l(t,s){i(!0),c("");const{response:d,error:m}=await g(`https://api.roadmap.sh/v1-respond-invite/${s}`,{status:t});if(m||!d){c(m?.message||"Something went wrong"),i(!1);return}t==="accept"?window.location.href=`/team/progress?t=${d.teamId}`:(window.dispatchEvent(new CustomEvent("refresh-notification",{detail:{count:r.length-1}})),o(r.filter(f=>f._id!==s)),i(!1))}return a.useEffect(()=>{h().finally(()=>{u.set("")})},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8 hidden md:block",children:[e.jsx("h2",{className:"text-3xl font-bold sm:text-4xl",children:"Notification"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Manage your notifications"})]}),r.length===0&&e.jsx("div",{className:"flex items-center justify-center mt-6",children:e.jsxs("p",{className:"text-gray-400",children:["No notifications, you can ",e.jsx("a",{href:"/team/new",className:"text-blue-500 underline hover:no-underline",children:"create a team"})," and invite your friends to join."]})}),e.jsx("div",{className:"space-y-4",children:r.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-2",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:t.name})})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",disabled:n,className:"inline-flex border p-1 rounded hover:bg-gray-50 disabled:opacity-75",onClick:()=>l("accept",t?._id),children:e.jsx("img",{src:b.src,className:"h-4 w-4"})}),e.jsx("button",{type:"button",disabled:n,className:"inline-flex border p-1 rounded hover:bg-gray-50 disabled:opacity-75",onClick:()=>l("reject",t?._id),children:e.jsx("img",{alt:"Close",src:v.src,className:"h-4 w-4"})})]})]}))})]})}export{$ as NotificationPage};
