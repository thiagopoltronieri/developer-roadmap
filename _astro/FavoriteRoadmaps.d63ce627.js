import{j as e}from"./jsx-runtime.391947bd.js";import{r as c}from"./index.ed373d49.js";import{C as x}from"./CheckIcon.5f09e048.js";import{a as y}from"./http.64a7434f.js";import{MarkFavorite as j}from"./MarkFavorite.7c52aa76.js";import{S as b}from"./Spinner.cc2f813e.js";import{c as w}from"./createLucideIcon.f8abb06c.js";import{i as I}from"./jwt.1b92699e.js";import"./popup.a359f713.js";import"./use-toast.fb52de5d.js";import"./toast.1fe7142d.js";import"./index.a98c85f5.js";const N=w("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);function T(a){const{title:s="Start learning ..",message:o="Your progress and favorite roadmaps will show up here."}=a;return e.jsxs("div",{className:"relative flex min-h-full flex-col items-start sm:items-center justify-center py-6",children:[e.jsxs("h2",{className:"mb-1 flex items-center text-lg sm:text-2xl text-gray-200",children:[e.jsx(x,{additionalClasses:"mr-2 top-[0.5px] w-[16px] h-[16px] sm:w-[20px] sm:h-[20px]"}),"Start learning .."]}),e.jsx("p",{className:"text-gray-400 text-sm sm:text-base",children:o})]})}function p(a){const{url:s,percentageDone:o,resourceType:r,resourceId:i,resourceTitle:t,isFavorite:l,allowFavorite:d=!0}=a;return e.jsxs("a",{href:s,className:"relative flex flex-col overflow-hidden rounded-md border border-slate-800 bg-slate-900 p-3 text-sm text-slate-400 hover:border-slate-600 hover:text-slate-300",children:[e.jsx("span",{className:"relative z-20",children:t}),e.jsx("span",{className:"absolute bottom-0 left-0 top-0 z-10 bg-[#172a3a]",style:{width:`${o}%`}}),d&&e.jsx(j,{resourceId:i,resourceType:r,favorite:l})]})}function u(a){const{isLoading:s=!1,title:o,icon:r}=a;return e.jsxs("p",{className:"mb-4 flex items-center text-sm text-gray-400",children:[!s&&r,s&&e.jsx("span",{className:"mr-1.5",children:e.jsx(b,{})}),o]})}function E(a){const{progress:s,isLoading:o=!1,customRoadmaps:r=[{}],showCustomRoadmaps:i=!1}=a;return e.jsxs("div",{className:"relative pb-12 pt-4 sm:pt-7",children:[e.jsx(u,{icon:e.jsx(x,{additionalClasses:"mr-1.5 h-[14px] w-[14px]"}),isLoading:o,title:"Your progress and favorite roadmaps."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:s.map(t=>e.jsx(p,{resourceId:t.resourceId,resourceType:t.resourceType,resourceTitle:t.resourceTitle,isFavorite:t.isFavorite,percentageDone:(t.skipped+t.done)/t.total*100,url:t.resourceType==="roadmap"?`/${t.resourceId}`:`/best-practices/${t.resourceId}`},t.resourceId))}),i&&e.jsxs("div",{className:"mt-5",children:[e.jsx(u,{icon:e.jsx(N,{className:"mr-1.5 h-[14px] w-[14px]"}),title:"Your custom roadmaps"}),r.length===0&&e.jsxs("p",{className:"rounded-md border border-dashed border-gray-800 p-2 text-sm text-gray-600",children:["You haven't created any custom roadmaps yet."," ",e.jsx("button",{className:"text-gray-500 underline underline-offset-2 hover:text-gray-400",children:"Create one!"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:r.map(t=>e.jsx(p,{resourceId:"343434",resourceType:"roadmap",resourceTitle:"Frontend Roadmap Revised",percentageDone:50,url:"/r?34343434",allowFavorite:!1}))})]})]})}function $(a){a.forEach(s=>{const o=s.resourceType==="best-practice"?`/best-practices/${s.resourceId}`:`/${s.resourceId}`,r=document.querySelector(`a[href="${o}"]`);if(!r)return;window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceId:s.resourceId,resourceType:s.resourceType,isFavorite:s.isFavorite}}));const t=(s.done+s.skipped)/s.total*100,l=r.querySelector("[data-progress]");l&&(l.style.width=`${t}%`)})}function M(){if(!I())return null;const[s,o]=c.useState(!0),[r,i]=c.useState(!0),[t,l]=c.useState([]),[d,f]=c.useState(0);function h(){const n=document.getElementById("hero-text");n&&(n.classList.add("opacity-0"),setTimeout(()=>{n.parentElement?.removeChild(n),o(!1),setTimeout(()=>{f(100)},50)},0))}async function m(){i(!0);const{response:n,error:v}=await y("https://api.roadmap.sh/v1-get-user-all-progress");v||!n||(l(n),i(!1),h(),$(n))}if(c.useEffect(()=>{m().finally(()=>{i(!1)})},[]),c.useEffect(()=>(window.addEventListener("refresh-favorites",m),()=>window.removeEventListener("refresh-favorites",m)),[]),s)return null;const g=t.length>0;return e.jsx("div",{className:`flex min-h-[192px] bg-gradient-to-b transition-opacity duration-500 sm:min-h-[280px] opacity-${d} ${g&&"border-t border-t-[#1e293c]"}`,children:e.jsxs("div",{className:"container min-h-full",children:[!r&&t.length==0&&e.jsx(T,{}),t.length>0&&e.jsx(E,{customRoadmaps:[],progress:t,isLoading:r})]})})}export{M as FavoriteRoadmaps};
